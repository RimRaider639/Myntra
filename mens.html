<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mens</title>
    <link rel="shortcut icon" href="img/myntra.svg" type="image/x-icon">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cabin:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/navbar.css">
    <link rel="stylesheet" href="css/common.css">

    <style>
        #body{
            display: flex;
        }
        #filter{
            display: flex;
            flex-direction: column;
        }
        #container-parent{
            width:80%;
        }
        #container{
            width:100%;
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 30px;
            border: 1px solid black;
        }
        #container>div>img{
            width: 100%;
        }
        #container p{
            color:#282c3f;
            font-size: 16px;
            font-weight: 400;
        }
        .price>strike{
            margin: 0 5px;
            font-weight: 500;
            font-size: 12px;
            color: #7e818c;
        }
        .price>span{
            color:#ff905a;
            font-size: 12px
        }

    </style>
</head>
<body>
    <!-- navbar -->
    <div id="nav">
        <div>
            <img src="img/myntra_navbar_logo.png" alt="">
        </div>
        <div>
            <div><a href="">MEN</a></div>
            <div><a href="">WOMEN</a></div>
            <div><a href="">KIDS</a></div>
            <div><a href="">HOME & LIVING</a></div>
            <div><a href="">BEAUTY</a></div>
            <div><a href="">STUDIO</a></div>
        </div>
        <div>
            <span class="material-symbols-outlined">
                search
                </span>
            <input type="text" id="search" placeholder="Search for products, brands and more">
        </div>
        <div>
            <div class="ic-text">
                <span class="material-symbols-outlined">
                    person
                    </span>
                <span>Profile</span>
            </div>
            <div class="ic-text">
                <span class="material-symbols-outlined">
                    favorite
                    </span>
                <span>Wishlist</span>
            </div>
            <div class="ic-text">
                <span class="material-symbols-outlined">
                    shopping_bag
                    </span>
                <span>Bag</span>
            </div>
        </div>
    </div>
    <!-- END OF NAVBAR -->

    <div id="body">
        <div id="filter"></div>
        <div id="container-parent">
            <div id="container"></div>
        </div>
        
    </div>
</body>
<script src="js/storeData.js"></script>
<script>
    // let mensAll = JSON.parse(localStorage.getItem('mensAll'))
    let brands_to_filter = []
    let price_range_to_filter = []
    mensAll = mensAll.slice(0,20)
    display(mensAll)

    // filters
    // filter by brand
    let brandLbl = document.createElement("h2")
    brandLbl.innerText = "BRANDS"
    let brandSec = document.createElement("div")
    let i = 0;
    for (let brand in brands_men){
        let check = document.createElement('input')
        check.type = "checkbox"
        check.id = "b"+i
        check.value = brand
        check.addEventListener('change', function(b){
            if (b.target.checked && !brands_to_filter.includes(b.target.value)){
                    brands_to_filter.push(b.target.value)
            } else{
                brands_to_filter.splice(brands_to_filter.indexOf(b.target.value), 1)
            }
            filter_by_brand()
        })
        let name = document.createElement("label")
        name.innerText = brand + " (" + brands_men[brand] + ")"
        let br = document.createElement('br')
        brandSec.append(check, name, br)
        i++
    }

    // filter by prices
    let priceLbl = document.createElement("h2")
    priceLbl.innerText = "PRICE"
    let priceSec = document.createElement("div")
    let j = 0;
    for (let price in prices_men){
        let check = document.createElement('input')
        check.type = "checkbox"
        check.id = "p"+j
        check.value = price
        check.addEventListener('change', function(p){
            if (p.target.checked && !price_range_to_filter.includes(p.target.value)){
                    price_range_to_filter.push(p.target.value)
            } else{
                price_range_to_filter.splice(price_to_filter.indexOf(p.target.value), 1)
            }
            console.log(price_range_to_filter)
            filter_by_price()
        })
        let name = document.createElement("label")
        name.innerText = prices_men.min + "-" + (prices_men.min + prices_men.interval) + " (" + prices_men[price].length + ")"
        let br = document.createElement('br')
        brandSec.append(check, name, br)
        j++
    }
    document.querySelector("#filter").append(brandLbl, brandSec, priceLbl, priceSec)

    function display(list){
        document.querySelector("#container").innerHTML = null
        list.forEach(function(prod, index){
            let card = document.createElement('div')
            let imagesLinks = prod.images.split("|")
            let img = document.createElement("img")
            img.src = imagesLinks[0]
            let brand = document.createElement("h4")
            brand.innerText = prod.brand
            let title = document.createElement("p")
            title.innerText = prod.title
            let price = document.createElement("h4")
            price.setAttribute("class", "price")
            price.innerHTML = "Rs."+prod.price + (prod.strike_off==prod.price?"":"<strike> Rs." + prod.strike_off + " </strike>") + "<span>" + (prod.strike_off==prod.price?"":"("+Math.round((1-(+prod.price/+prod.strike_off))*100)+"% OFF)") + "</span>"
            

            card.append(img, brand, title, price)
            document.querySelector("#container").append(card)
        })
        
    }
    function filter_by_brand(){
        if (brands_to_filter.length == 0){
            display(mensAll)
            return
        }
        filtered = mensAll.filter(function(prod){
            return brands_to_filter.includes(prod.brand)
        })
        display(filtered)
    }
    function filter_by_price(){
        if (price_range_to_filter.length == 0){
            display(mensAll)
            return
        }
        filtered = price_range_to_filter.forEach(function(range){

        })
        console.log(filtered)
        display(filtered)
    }
</script>
</html>

